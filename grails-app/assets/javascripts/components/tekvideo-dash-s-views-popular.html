<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-item/paper-icon-item.html">
<link rel="import" href="../bower_components/paper-item/paper-item-body.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<script src="../bower_components/chart.js/dist/Chart.bundle.min.js"></script>

<dom-module id="tekvideo-dash-s-views-popular">

<template>
<style>
:host {
    display: block;
}

paper-card {
    width: 100%;
    height: 100%;
}

.avatar {
      display: inline-block;
      box-sizing: border-box;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--paper-amber-500);
    }
</style>

<paper-card heading="Populære Videoer">
    <div class="card-content">
        Dette kort viser de mest populære videoer over perioden {{periodFrom}} til {{periodTo}}.
        <iron-ajax
            auto
            url="[[baseUrl]]dashboard/popularVideos?identifier=[[node]]&periodFrom=[[periodFrom]]&periodTo=[[periodTo]]"
            handle-as="json"
            debounce-duration="300"
            last-response="{{popularVideos}}">
        </iron-ajax>

        <div role="listbox">
            <template is="dom-repeat" items="{{popularVideos}}">
                <paper-icon-item>
                    <div class="avatar blue" item-icon></div>
                    <paper-item-body two-line>
                        <div>
                            {{item.videoName}}
                            <span secondary>fra {{item.courseName}} / {{item.subjectName}}</span>
                        </div>
                        <div secondary>{{item.visits}} visninger &mdash; {{item.correctAnswers}} rigtige ud af {{item.answerCount}} svar</div>
                    </paper-item-body>
                </paper-icon-item>
            </template>
        </div>
    </div>
</paper-card>

</template>

<script>
Polymer({
    is: 'tekvideo-dash-s-views-popular',
    properties: {
        node: {
            type: String
        },
        periodFrom: {
            type: Number
        },
        periodTo: {
            type: Number
        },
        baseUrl: {
            type: String
        },
    }
});
</script>
</dom-module>